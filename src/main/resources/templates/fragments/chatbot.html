<!--
    Chatbot Fragment - AI Assistant for Shoe Store
    Include this in your main layout with: th:replace="fragments/chatbot :: chatbot"
-->
<div th:fragment="chatbot">
    <!-- Floating Chat Button -->
    <button class="chatbot-toggle" id="chatbotToggle" aria-label="Open chat">
        <!-- Icon Closed (Support Headset) -->
        <svg class="chatbot-icon icon-closed" viewBox="0 0 24 24">
            <path
                d="M19 15.5a4.5 4.5 0 0 0-4.5-4.5h-5A4.5 4.5 0 0 0 5 15.5v3a1.5 1.5 0 0 0 1.5 1.5h11a1.5 1.5 0 0 0 1.5-1.5v-3z" />
            <path d="M12 11V6a4 4 0 0 1 4-4h.5a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-.5.5H16a2 2 0 0 0-2 2v2.5" />
            <circle cx="12" cy="6" r="3" />
        </svg>
        <!-- Icon Open (X) -->
        <svg class="chatbot-icon icon-open hidden" viewBox="0 0 24 24">
            <path d="M18 6 6 18" />
            <path d="m6 6 12 12" />
        </svg>
    </button>

    <!-- Chat Widget Container -->
    <div class="chatbot-widget" id="chatbotWidget">

        <!-- VIEW 1: WELCOME SCREEN (Like Cake Bank example) -->
        <div class="chatbot-view welcome-view" id="welcomeView">
            <div class="welcome-header">
                <div class="brand-logo">
                    <img th:src="@{/images/logo-shop/logo-sneaker.png}" alt="Logo"
                        onerror="this.src='https://cdn-icons-png.flaticon.com/512/2589/2589903.png'">
                </div>
                <h2 class="brand-name">Shoe Store Support</h2>
                <p class="brand-greeting">
                    Ch√†o b·∫°n! üëã<br>
                    M√¨nh l√† nh√¢n vi√™n t∆∞ v·∫•n c·ªßa c·ª≠a h√†ng. B·∫°n ƒëang t√¨m m·∫´u gi√†y n√†o, ƒë·ªÉ m√¨nh h·ªó tr·ª£ nh√©?
                </p>
            </div>

            <div class="welcome-actions">
                <button class="start-chat-btn" id="startChatBtn">
                    <div class="btn-content">
                        <span class="btn-title">B·∫Øt ƒë·∫ßu tr√≤ chuy·ªán</span>
                        <span class="btn-subtitle">Ch√∫ng t√¥i th∆∞·ªùng tr·∫£ l·ªùi ngay l·∫≠p t·ª©c</span>
                    </div>
                    <svg class="btn-arrow" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                        stroke-linecap="round" stroke-linejoin="round">
                        <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z" />
                    </svg>
                </button>
            </div>

            <div class="welcome-footer">
                <span>Powered by <strong>ShoeAI</strong></span>
            </div>
        </div>

        <!-- VIEW 2: CONVERSATION SCREEN (Standard Chat) -->
        <div class="chatbot-view conversation-view hidden" id="conversationView">
            <!-- Header -->
            <div class="chatbot-header">
                <div class="chatbot-header-left">
                    <button class="chatbot-back" id="chatbotBack" aria-label="Back">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                            stroke-linecap="round" stroke-linejoin="round">
                            <path d="m15 18-6-6 6-6" />
                        </svg>
                    </button>
                    <div class="chatbot-avatar-small">
                        <img th:src="@{/images/logo-shop/logo-sneaker.png}" alt="Bot"
                            onerror="this.src='https://cdn-icons-png.flaticon.com/512/4712/4712035.png'">
                    </div>
                    <div class="chatbot-header-info">
                        <h3 class="chatbot-title">Chuy√™n vi√™n t∆∞ v·∫•n</h3>
                        <span class="chatbot-status">Online</span>
                    </div>
                </div>
                <div class="chatbot-header-right">
                    <button class="header-action-btn" title="More options">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                            stroke-linecap="round" stroke-linejoin="round">
                            <circle cx="12" cy="12" r="1" />
                            <circle cx="12" cy="5" r="1" />
                            <circle cx="12" cy="19" r="1" />
                        </svg>
                    </button>
                </div>
            </div>

            <!-- Messages Message List -->
            <div class="chatbot-messages" id="chatbotMessages">
                <!-- Messages will be added here by JS -->
            </div>

            <!-- Input Area -->
            <div class="chatbot-input-area">
                <input type="text" class="chatbot-input" id="chatbotInput" placeholder="Nh·∫≠p tin nh·∫Øn..."
                    autocomplete="off">
                <button class="chatbot-send" id="chatbotSend">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="m22 2-7 20-4-9-9-4Z" />
                        <path d="M22 2 11 13" />
                    </svg>
                </button>
            </div>
        </div>

    </div>
</div>